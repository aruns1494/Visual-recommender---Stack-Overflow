<!doctype html>
<html>
	<head>
		<title> user Tag Distribution </title>
		<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.min.css" rel="stylesheet" />
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.min.js"></script>
	</head>

	<body>
		<div id = 'donut' class='donut-chart'></div>
		<script type="text/javascript">
			var a = $.ajax({
				dataType: "json",
				url: "/getUserData",
				type: 'GET',
				success : function(res){
					getData(res)
				}
			})
			function getData(data){
				b = data;
				var k = JSON.parse(JSON.stringify(b))
				generateGraph(k.currentUser,k.user_id)
			}
			//var headings = []
			var vals = []
			function generateGraph(dataCol,name){
				for (var i = dataCol.length - 1; i >= 0; i--) {
					var headings = []
					if (dataCol[i]['tags']['name'] == '') {
						headings.push("EmptyTag")
					}
					else{
						headings.push(dataCol[i]['tags']['name']);
					}
					headings.push(dataCol[i]['tags']['count'])
					vals.push(headings)
				}
				var chart = c3.generate({
					bindto:'#donut',
					data:{
						columns:[
						],
						type: 'donut',
					},
					donut:{
						title:name+'\'s tag distribution'
					}	
				});
				addToChart(chart)
			};
			function addToChart(chart3){
				for (var i = vals.length - 1; i >= 0; i--) {
					chart3.load({
						columns:[
							vals[i]
						]
					});
				}
			};
		</script>
	</body>
</html>